---
title: "Project Milestone 3: Preliminary progress report"
format:
  html:
    toc: true
    toc-depth: 2
    embed-resources: true
---

```{r include = FALSE}
# This chunk just sets up some styling (eg: default size of our images)
knitr::opts_chunk$set(
  collapse = TRUE, 
  warning = FALSE,
  message = FALSE,
  fig.height = 2.75, 
  fig.width = 4.25,
  fig.align = 'center')
```

\

**NOTE**

This progress report represents the *minimum* progress you need to make in order to stay on track. You're encouraged to do more, if possible. For example:

-   Though your responses to *this* progress report can be informal, take some time to:
    -   Edit written responses as they might appear in your final report.
    -   Edit code and plots as they might appear in your final report (eg: use figure captions, alt text, color-blind friendly palettes, etc).
-   Make more plots! Do more wrangling! Learn new things!

\
\

# Names

Put the full names (first and last) of every group member here.
  - Gaby Moreno Romero
  - Kampe Rushoka
  - Val Tlahuice


\
\

# 1. Background

In this section, specify:

-   The overarching **research question** for your project. You will break this down into smaller pieces in your analysis, but should have a general guiding question.

-   Specify your data sources, including *where* you found your dataset(s) and who *originally* collected the data. If possible, also identify the original purpose for this data collection.

Put your work below:

RQ: How have demographics (Sex, Race) and education levels affected Americans wages over time? 

Data source: The Wages by Education dataset was found from Kaggle and provides provides hourly wages by the highest level of education attained for wage and salary workers aged 16 and older in the USA and disagregated for other demographic factors such as sex (Male and Female) and ethnicities(White, Black, and Hispanic). The data is adjusted into 2022 dollars using the CPI-U-RS index, to acount for inflation. It covers the years from 1973 to 2022 and is sourced from the Economic Policy Institute’s State of Working America Data Library. It is important to note some demographics such as asian, indigenous, non-binary and trans identities are missing. 






\
\
\
\

# 2. Preliminary data checks and cleaning

In this section:

-   Import your dataset(s).

-   Do a preliminary data check. For *example*, identify:

    -   units of observation 
    -   how many data points you have
    -   the number of variables and types of things that were measured

-   Do any preliminary data cleaning that's necessary to start your analysis. For example:

    -   define / clean the variables you plan to use in your analysis
    -   obtain some simple summaries of the variables you plan to use in your analysis
    -   as necessary:
        -   reshape the data
        -   join datasets

Put your work below:

Preliminary Data:
- Units of observation: Aggregated demographic-year wages within the U.S.

- Number of data points: 4,500 entries (each representing a unique demographic-year combination).

- Variables measured: Demographic information: Categories such as race (Black, White), education level (less than high school), gender (women), and all possible combinations, Year: The year in which the wage data was measured, Wages: Hourly wages adjusted to 2022 dollars. 

Preliminary data cleaning and refinement:
We defined and cleaned the variables to ensure consistency for analysis. We also combined both median and average wage data from the Economic Policy Institute. This helps reduce the influence of extreme values, as averages can be skewed by very high or very low wages. Lastly we pivoted the data to a longer format to capture all demographic-year combinations efficiently. The dataset spans 1973–2022, with wages ranging from $10.74 to $64.04 per hour.

```{r}
library(readr)
library(dplyr)
library(tidyverse)

#demographic_data <- read_csv("~/Documents/DS 112/Projects/wages_by_education.csv")

demographic_data <- read_csv("wages_by_education.csv")

#median_wage <- read_csv("~/Documents/DS 112/Projects/median_average_wages 3.csv")

median_wage <- read_csv("median_average_wages 3.csv")


Combined_data <- left_join(median_wage,demographic_data, by = "year") %>% 
  arrange(year)

head(Combined_data, 3)


#Cleaned data with: Full Pivot longer of all demographic indicators
cleaned_data_1 <- Combined_data %>% 
  pivot_longer(cols = -year , names_to = "demographic", values_to = "Wages")

head(cleaned_data_1, 15)
nrow(cleaned_data_1)
summary(cleaned_data_1) 


library (tidyr)
demographic_data <- read_csv("~/Documents/DS 112/Projects/wages_by_education.csv")
head(demographic_data)

median_wage <- read_csv("~/Documents/DS 112/Projects/median_average_wages.csv")
head(median_wage)

Combined_data <- left_join(median_wage,demographic_data, by = "year")

cleaned_data_1 <- Combined_data %>% 
  pivot_longer(cols = -year , names_to = "demographic", values_to = "Wages")

head(cleaned_data_1)
```

Do a preliminary data check. For *example*, identify:

```{r}
# gender wage ratio by demographics group 

cleaned_data_6 <- Combined_data %>% 
  mutate(wage_ratio_overall= women_median/men_median,
         wage_ratio_white= white_women_median/ white_men_median,
         wage_ratio_black=  black_women_median/ black_men_median,
         wage_ratio_hispanic= hispanic_women_median/ hispanic_men_median) %>% 
  select(year,wage_ratio_overall, wage_ratio_white, wage_ratio_black, wage_ratio_hispanic)  
cleaned_data_6 %>% 
  select(year,wage_ratio_overall, wage_ratio_white, wage_ratio_black, wage_ratio_hispanic) 
```
\
\
\
\

# 3. Preliminary analysis (OPTIONAL)



In this section, you are encouraged to build and perhaps discuss some plots *and* numerical summaries that address your research question(s). Though this section technically isn't required, any extra analysis you do now will support and simplify your future work.

Put your work below:
Preliminary Analysis of Wage Trends

Gender Differences: In the gender graph, men consistently earn more than women, although the gender wage gap has narrowed over time. The trend lines show that while both groups experience general wage growth, women’s wages have increased at a slightly faster rate, helping to reduce—but not eliminate—the disparity.

Racial: In the race/ethnicity graph, White men have the highest median wages, with a clear gap above other groups. Black and Hispanic median wages are noticeably lower but relatively close to each other. While all groups exhibit some upward wage movement over time, the relative ranking between them remains stable, indicating persistent racial  wage disparties.

Education Level Differences: The education-level graph shows a strong and consistent pattern: higher education is associated with higher wages. The wage hierarchy follows the expected order:Advanced degree holders earn the highest wages, Bachelor’s degree holders follow, Some college, high school, and less than high school form a lower cluster with wages in a relatively similar and lower range.

Notably, the groups with lower education levels do not show the same long-term upward trend as other demographics. Instead, wages for individuals with less than high school, high school, or some college education have experienced a small but concerning decline over the years, emphasizing widening wage inequality by education level.
```{r}
library(tidyverse)
#Wages of White women vs Wages of Black women same education: 
#Gender 
cleaned_data_3 <- Combined_data %>% 
  select(men_median, women_median, year) %>%
  pivot_longer(cols = -year , names_to = "demographic", values_to = "Wages") 
  
ggplot(cleaned_data_3, aes(x = year, y = Wages, color = demographic)) + 
  geom_point() + 
  geom_line()+ 
    labs(title = "Wage Trends by Gender (1973–2022)")

#Race
cleaned_data_4 <- Combined_data %>% 
  select(white_median, black_median, hispanic_median, year) %>%
  pivot_longer(cols = -year , names_to = "demographic", values_to = "Wages") 

ggplot(cleaned_data_4, aes(x = year, y = Wages, color = demographic)) + 
  geom_point() + 
  geom_line() + 
    labs(title = "Wage Trends by Race (1973–2022)")

#Education: 
cleaned_data_5 <- Combined_data %>% 
  select(less_than_hs, high_school, some_college, bachelors_degree, advanced_degree, year) %>%
  pivot_longer(cols = -year , names_to = "demographic", values_to = "Wages") 

ggplot(cleaned_data_5, aes(x = year, y = Wages, color = demographic)) + 
  geom_point() + 
  geom_line() + 
  labs(title = "Wage Trends by Education Level (1973–2022)")

# gender wage ratio by race:

cleaned_data_6 %>%  
 pivot_longer(cols = -year , names_to = "demographic", values_to = "Wages") %>% 
  
ggplot(aes(x = year, y = Wages, color = demographic)) + 
  geom_point() + 
  geom_line() 

```

```{r}
library(patchwork)
# Density plot of different education levels: 
#Less than High school
less_hs_data <- cleaned_data_1 %>% 
  filter(str_ends(demographic,"less_than_hs")) %>% 
  mutate(
    Race = case_when(
      str_starts(demographic, "white") ~ "White",
      str_starts(demographic, "black") ~ "Black",
      str_starts(demographic, "hispanic") ~ "Hispanic",
      TRUE ~ "NA"
    )) %>% 
  mutate(
    Gender = case_when(
      str_detect(demographic, "_men_") ~ "Men",
      str_detect(demographic, "_women_") ~ "Women",
      TRUE ~ "NA"
    )) %>%
  filter(Race != "NA", Gender != "NA") 

less_hs_data

plot_first <- ggplot(less_hs_data, aes(x = Wages, fill = Gender)) +
  geom_density(alpha = 0.5) +
  facet_wrap(~Race) +
  labs(title = "Less than high school wage gaps")



# High school
hs <-  cleaned_data_1 %>% 
  filter(str_ends(demographic,"high_school")) %>% 
  mutate(
    Race = case_when(
      str_starts(demographic, "white") ~ "White",
      str_starts(demographic, "black") ~ "Black",
      str_starts(demographic, "hispanic") ~ "Hispanic",
      TRUE ~ "NA"
    )) %>% 
  mutate(
    Gender = case_when(
      str_detect(demographic, "_men_") ~ "Men",
      str_detect(demographic, "_women_") ~ "Women",
      TRUE ~ "NA"
    )) %>%
  filter(Race != "NA", Gender != "NA") 



ggplot(hs, aes(x = Wages, fill = Gender)) +
  geom_density(alpha = 0.5) +
  facet_wrap(~Race)


# Some College
some_college_data <-  cleaned_data_1 %>% 
  filter(str_ends(demographic,"some_college")) %>% 
  mutate(
    Race = case_when(
      str_starts(demographic, "white") ~ "White",
      str_starts(demographic, "black") ~ "Black",
      str_starts(demographic, "hispanic") ~ "Hispanic",
      TRUE ~ "NA"
    )) %>% 
  mutate(
    Gender = case_when(
      str_detect(demographic, "_men_") ~ "Men",
      str_detect(demographic, "_women_") ~ "Women",
      TRUE ~ "NA"
    )) %>%
  filter(Race != "NA", Gender != "NA") 



ggplot(some_college_data, aes(x = Wages, fill = Gender)) +
  geom_density(alpha = 0.5) +
  facet_wrap(~Race)

# Bachelors degree
bachelor_data <-  cleaned_data_1 %>% 
  filter(str_ends(demographic,"bachelors_degree")) %>% 
  mutate(
    Race = case_when(
      str_starts(demographic, "white") ~ "White",
      str_starts(demographic, "black") ~ "Black",
      str_starts(demographic, "hispanic") ~ "Hispanic",
      TRUE ~ "NA"
    )) %>% 
  mutate(
    Gender = case_when(
      str_detect(demographic, "_men_") ~ "Men",
      str_detect(demographic, "_women_") ~ "Women",
      TRUE ~ "NA"
    )) %>%
  filter(Race != "NA", Gender != "NA") 



ggplot(bachelor_data, aes(x = Wages, fill = Gender)) +
  geom_density(alpha = 0.5) +
  facet_wrap(~Race)

#Advanced degree: 
advanced_data <-  cleaned_data_1 %>% 
  filter(str_ends(demographic,"advanced_degree")) %>% 
  mutate(
    Race = case_when(
      str_starts(demographic, "white") ~ "White",
      str_starts(demographic, "black") ~ "Black",
      str_starts(demographic, "hispanic") ~ "Hispanic",
      TRUE ~ "NA"
    )) %>% 
  mutate(
    Gender = case_when(
      str_detect(demographic, "_men_") ~ "Men",
      str_detect(demographic, "_women_") ~ "Women",
      TRUE ~ "NA"
    )) %>%
  filter(Race != "NA", Gender != "NA") 



plot_second <- ggplot(advanced_data, aes(x = Wages, fill = Gender)) +
  geom_density(alpha = 0.5) +
  facet_wrap(~Race)+
  labs(title = "Advanced degree wage gaps")

plot_first + plot_second
```

```{r}
gap_data <- Combined_data %>%
  mutate(gender_gap = men_median - women_median)

ggplot(gap_data, aes(x = year, y = gender_gap)) + 
  geom_line(color = "firebrick", size = 1.2) +
  theme_minimal() +
  labs(title = "Gender Wage Gap Over Time",
       y = "Hourly Wage Gap [Men Median vs Women Median]")

ggplot(cleaned_data_4, aes(x = year, y = Wages)) +
  geom_line(color = "steelblue") +
  facet_wrap(~ demographic, scales = "free_y") +
  theme_minimal() +
  labs(title = "Wage Trends by Race (1970–2020)")

slope_data <- Combined_data %>%
  filter(year %in% c(2000, 2020)) %>%
  select(year, white_median, black_median, hispanic_median) %>%
  pivot_longer(cols = -year, names_to = "demographic", values_to = "Wages")

ggplot(slope_data, aes(x = factor(year), y = Wages, group = demographic, color = demographic)) +
  geom_line(size = 1.2) +
  geom_point(size = 3) +
  theme_minimal() +
  labs(title = "Wage Change by Race (2000 → 2020)")

```
\
\
\
\

# 4. Vision

Remember that growth and depth are key components of the final project assessment. Identify here what types of tools / skills do you plan to learn throughout the course of this project (or perhaps even what new things you already learned)! Revisit the project overview for ideas.

Put your work below:

One major area of improvement is learning how to reshape datasets. Specifically, understanding how to use pivot longer/ wider and joints more confidently, since those have been some of the trickiest parts of the course for some of us. 

Also, we want to improve our interpretation of wage trends by connecting statistical patterns to broader social and economic contexts in the United States. For this, it is important to also improve how to create clear and comparative visualization, especially when we have plots that show differences across sex, race, and education levels at the same time.

Finally, we want to be mindful about missing groups (such as Asian, Indigenous, non-binary) when interpreting results. As we continue, we want to strengthen both the technical R skills and the critical reasoning needed to analyze wage inequality over time.

\
\
\
\

# 5. Reflection form

Only after you've completed items 1--4 above, each individual group member must fill out this [reflection form](https://forms.gle/xCtgxM2fxYjcCJvn6).



\
\
\
\

# Wrapping up

-   Render your qmd to html, check/fix the formatting, then submit the html!
-   Remember that this progress report represents the *minimum* progress you need to make in order to stay on track. You're encouraged to do more, if possible. Ideas are outlined at the top of this assignment.
